apiVersion: operator.victoriametrics.com/v1beta1
kind: VMAgent
metadata:
  name: vmagent-smallset
  namespace: monitoring
spec:
  image:
    repository: quay.io/cybozu/victoriametrics-vmagent
    tag: 1.52.0.1
  containers:
    - name: config-reloader
      image: quay.io/cybozu/prometheus-config-reloader:0.45.0.2
  serviceScrapeSelector:
    matchLabels:
      smallset: "true"
  podScrapeSelector:
    matchLabels:
      smallset: "true"
  nodeScrapeSelector:
    matchLabels:
      smallset: "true"
  probeSelector:
    matchLabels:
      smallset: "true"
  replicaCount: 1
  remoteWrite:
    - url: "http://vmsingle-vmsingle-smallset.monitoring.svc:8429/api/v1/write"
  resources:
    requests:
      cpu: 100m
      memory: 200Mi
